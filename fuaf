--[[
    Modern UI Library for Executors
    Version: 1.0.0
    Created: 2025
    
    Features:
    - Modern design with theming support
    - Multiple pages and subpages
    - Various UI elements (Toggle, Slider, Button, Dropdown, Colorpicker, Keybind, Textbox)
    - Config system (save/load)
    - Notifications
    - Search functionality
    - Mobile support
    - Fully customizable
]]

if getgenv().UILibrary then
    getgenv().UILibrary:Destroy()
end

local UILibrary = {}
UILibrary.__index = UILibrary

-- Services
local TweenService = game:GetService("TweenService")
local UserInputService = game:GetService("UserInputService")
local RunService = game:GetService("RunService")
local HttpService = game:GetService("HttpService")
local Players = game:GetService("Players")
local CoreGui = game:GetService("CoreGui")

-- Protected GetService
local function GetCoreGui()
    return (gethui and gethui()) or (cloneref and cloneref(CoreGui)) or CoreGui
end

-- Player
local LocalPlayer = Players.LocalPlayer
local Mouse = LocalPlayer:GetMouse()

-- Utility Functions
local function Create(class, properties)
    local instance = Instance.new(class)
    for prop, val in pairs(properties) do
        instance[prop] = val
    end
    return instance
end

local function Tween(instance, properties, duration, style, direction)
    duration = duration or 0.2
    style = style or Enum.EasingStyle.Quad
    direction = direction or Enum.EasingDirection.Out
    
    local tween = TweenService:Create(instance, TweenInfo.new(duration, style, direction), properties)
    tween:Play()
    return tween
end

-- Library Setup
UILibrary.Flags = {}
UILibrary.Theme = {
    Background = Color3.fromRGB(15, 15, 15),
    Inline = Color3.fromRGB(25, 25, 25),
    Element = Color3.fromRGB(35, 35, 35),
    ElementHover = Color3.fromRGB(45, 45, 45),
    Border = Color3.fromRGB(50, 50, 50),
    Text = Color3.fromRGB(255, 255, 255),
    PlaceholderText = Color3.fromRGB(150, 150, 150),
    Accent = Color3.fromRGB(100, 150, 255),
}

UILibrary.Font = Font.fromEnum(Enum.Font.GothamBold)
UILibrary.IsMobile = UserInputService.TouchEnabled
UILibrary.KeybindList = nil
UILibrary.Notifications = {}

-- Keybind Handling
local Keys = {
    ["LeftControl"] = "LCtrl",
    ["RightControl"] = "RCtrl",
    ["LeftShift"] = "LShift",
    ["RightShift"] = "RShift",
    ["LeftAlt"] = "LAlt",
    ["RightAlt"] = "RAlt",
    ["CapsLock"] = "Caps",
    ["One"] = "1",
    ["Two"] = "2",
    ["Three"] = "3",
    ["Four"] = "4",
    ["Five"] = "5",
    ["Six"] = "6",
    ["Seven"] = "7",
    ["Eight"] = "8",
    ["Nine"] = "9",
    ["Zero"] = "0",
    ["Insert"] = "Ins",
    ["Delete"] = "Del",
    ["PageUp"] = "PgUp",
    ["PageDown"] = "PgDn",
}

local function GetKeyName(key)
    return Keys[key.Name] or key.Name
end

-- Main Window Creation
function UILibrary:CreateWindow(config)
    config = config or {}
    local Window = {
        Pages = {},
        CurrentPage = nil,
        Visible = true,
    }
    
    -- Create ScreenGui
    Window.ScreenGui = Create("ScreenGui", {
        Name = HttpService:GenerateGUID(false),
        Parent = GetCoreGui(),
        ZIndexBehavior = Enum.ZIndexBehavior.Sibling,
        ResetOnSpawn = false,
    })
    
    -- Main Container
    Window.Main = Create("Frame", {
        Name = "Main",
        Parent = Window.ScreenGui,
        BackgroundColor3 = UILibrary.Theme.Background,
        BorderSizePixel = 0,
        Position = UDim2.new(0.5, -350, 0.5, -250),
        Size = UDim2.new(0, 700, 0, 500),
    })
    
    Create("UICorner", {
        CornerRadius = UDim.new(0, 6),
        Parent = Window.Main,
    })
    
    Create("UIStroke", {
        Color = UILibrary.Theme.Border,
        Thickness = 1,
        Parent = Window.Main,
    })
    
    -- Title Bar
    Window.TitleBar = Create("Frame", {
        Name = "TitleBar",
        Parent = Window.Main,
        BackgroundColor3 = UILibrary.Theme.Inline,
        BorderSizePixel = 0,
        Size = UDim2.new(1, 0, 0, 40),
    })
    
    Create("UICorner", {
        CornerRadius = UDim.new(0, 6),
        Parent = Window.TitleBar,
    })
    
    -- Title
    Window.Title = Create("TextLabel", {
        Name = "Title",
        Parent = Window.TitleBar,
        BackgroundTransparency = 1,
        Position = UDim2.new(0, 15, 0, 0),
        Size = UDim2.new(1, -15, 1, 0),
        Font = UILibrary.Font,
        Text = config.Name or "UI Library",
        TextColor3 = UILibrary.Theme.Text,
        TextSize = 14,
        TextXAlignment = Enum.TextXAlignment.Left,
    })
    
    -- Tab Container
    Window.TabContainer = Create("Frame", {
        Name = "TabContainer",
        Parent = Window.Main,
        BackgroundColor3 = UILibrary.Theme.Inline,
        BorderSizePixel = 0,
        Position = UDim2.new(0, 0, 0, 45),
        Size = UDim2.new(0, 150, 1, -45),
    })
    
    Create("UIListLayout", {
        Parent = Window.TabContainer,
        SortOrder = Enum.SortOrder.LayoutOrder,
        Padding = UDim.new(0, 5),
    })
    
    Create("UIPadding", {
        Parent = Window.TabContainer,
        PaddingTop = UDim.new(0, 10),
        PaddingLeft = UDim.new(0, 10),
        PaddingRight = UDim.new(0, 10),
    })
    
    -- Page Container
    Window.PageContainer = Create("Frame", {
        Name = "PageContainer",
        Parent = Window.Main,
        BackgroundTransparency = 1,
        Position = UDim2.new(0, 160, 0, 50),
        Size = UDim2.new(1, -170, 1, -60),
    })
    
    -- Make Draggable
    local dragging, dragInput, dragStart, startPos
    
    Window.TitleBar.InputBegan:Connect(function(input)
        if input.UserInputType == Enum.UserInputType.MouseButton1 or input.UserInputType == Enum.UserInputType.Touch then
            dragging = true
            dragStart = input.Position
            startPos = Window.Main.Position
            
            input.Changed:Connect(function()
                if input.UserInputState == Enum.UserInputState.End then
                    dragging = false
                end
            end)
        end
    end)
    
    UserInputService.InputChanged:Connect(function(input)
        if input.UserInputType == Enum.UserInputType.MouseMovement or input.UserInputType == Enum.UserInputType.Touch then
            dragInput = input
        end
    end)
    
    RunService.Heartbeat:Connect(function()
        if dragging and dragInput then
            local delta = dragInput.Position - dragStart
            Window.Main.Position = UDim2.new(
                startPos.X.Scale,
                startPos.X.Offset + delta.X,
                startPos.Y.Scale,
                startPos.Y.Offset + delta.Y
            )
        end
    end)
    
    -- Create Page
    function Window:CreatePage(config)
        config = config or {}
        local Page = {
            Sections = {},
            Active = false,
        }
        
        -- Tab Button
        Page.TabButton = Create("TextButton", {
            Name = config.Name or "Page",
            Parent = Window.TabContainer,
            BackgroundColor3 = UILibrary.Theme.Element,
            BorderSizePixel = 0,
            Size = UDim2.new(1, 0, 0, 35),
            AutoButtonColor = false,
            Font = UILibrary.Font,
            Text = config.Name or "Page",
            TextColor3 = UILibrary.Theme.Text,
            TextSize = 12,
        })
        
        Create("UICorner", {
            CornerRadius = UDim.new(0, 4),
            Parent = Page.TabButton,
        })
        
        -- Page Content
        Page.Content = Create("ScrollingFrame", {
            Name = "Content",
            Parent = Window.PageContainer,
            Active = true,
            BackgroundTransparency = 1,
            BorderSizePixel = 0,
            Size = UDim2.new(1, 0, 1, 0),
            ScrollBarThickness = 4,
            ScrollBarImageColor3 = UILibrary.Theme.Accent,
            CanvasSize = UDim2.new(0, 0, 0, 0),
            AutomaticCanvasSize = Enum.AutomaticSize.Y,
            Visible = false,
        })
        
        Create("UIListLayout", {
            Parent = Page.Content,
            SortOrder = Enum.SortOrder.LayoutOrder,
            Padding = UDim.new(0, 10),
        })
        
        Create("UIPadding", {
            Parent = Page.Content,
            PaddingTop = UDim.new(0, 10),
            PaddingLeft = UDim.new(0, 10),
            PaddingRight = UDim.new(0, 10),
            PaddingBottom = UDim.new(0, 10),
        })
        
        -- Tab Click
        Page.TabButton.MouseButton1Click:Connect(function()
            for _, p in pairs(Window.Pages) do
                p:SetActive(false)
            end
            Page:SetActive(true)
        end)
        
        -- Hover Effect
        Page.TabButton.MouseEnter:Connect(function()
            if not Page.Active then
                Tween(Page.TabButton, {BackgroundColor3 = UILibrary.Theme.ElementHover})
            end
        end)
        
        Page.TabButton.MouseLeave:Connect(function()
            if not Page.Active then
                Tween(Page.TabButton, {BackgroundColor3 = UILibrary.Theme.Element})
            end
        end)
        
        function Page:SetActive(state)
            Page.Active = state
            Page.Content.Visible = state
            
            if state then
                Tween(Page.TabButton, {BackgroundColor3 = UILibrary.Theme.Accent})
                Window.CurrentPage = Page
            else
                Tween(Page.TabButton, {BackgroundColor3 = UILibrary.Theme.Element})
            end
        end
        
        -- Create Section
        function Page:CreateSection(name)
            local Section = {}
            
            Section.Container = Create("Frame", {
                Name = "Section",
                Parent = Page.Content,
                BackgroundColor3 = UILibrary.Theme.Element,
                BorderSizePixel = 0,
                Size = UDim2.new(1, 0, 0, 0),
                AutomaticSize = Enum.AutomaticSize.Y,
            })
            
            Create("UICorner", {
                CornerRadius = UDim.new(0, 4),
                Parent = Section.Container,
            })
            
            Create("UIStroke", {
                Color = UILibrary.Theme.Border,
                Thickness = 1,
                Parent = Section.Container,
            })
            
            Section.Title = Create("TextLabel", {
                Name = "Title",
                Parent = Section.Container,
                BackgroundTransparency = 1,
                Position = UDim2.new(0, 10, 0, 5),
                Size = UDim2.new(1, -20, 0, 25),
                Font = UILibrary.Font,
                Text = name or "Section",
                TextColor3 = UILibrary.Theme.Accent,
                TextSize = 13,
                TextXAlignment = Enum.TextXAlignment.Left,
            })
            
            Section.ElementContainer = Create("Frame", {
                Name = "Elements",
                Parent = Section.Container,
                BackgroundTransparency = 1,
                Position = UDim2.new(0, 0, 0, 35),
                Size = UDim2.new(1, 0, 0, 0),
                AutomaticSize = Enum.AutomaticSize.Y,
            })
            
            Create("UIListLayout", {
                Parent = Section.ElementContainer,
                SortOrder = Enum.SortOrder.LayoutOrder,
                Padding = UDim.new(0, 8),
            })
            
            Create("UIPadding", {
                Parent = Section.ElementContainer,
                PaddingTop = UDim.new(0, 5),
                PaddingLeft = UDim.new(0, 10),
                PaddingRight = UDim.new(0, 10),
                PaddingBottom = UDim.new(0, 10),
            })
            
            -- Create Toggle
            function Section:CreateToggle(config)
                config = config or {}
                local Toggle = {
                    Value = config.Default or false,
                    Flag = config.Flag,
                }
                
                Toggle.Container = Create("Frame", {
                    Name = "Toggle",
                    Parent = Section.ElementContainer,
                    BackgroundTransparency = 1,
                    Size = UDim2.new(1, 0, 0, 20),
                })
                
                Toggle.Button = Create("TextButton", {
                    Name = "Button",
                    Parent = Toggle.Container,
                    BackgroundColor3 = UILibrary.Theme.Inline,
                    BorderSizePixel = 0,
                    Size = UDim2.new(0, 40, 0, 20),
                    AutoButtonColor = false,
                    Text = "",
                })
                
                Create("UICorner", {
                    CornerRadius = UDim.new(1, 0),
                    Parent = Toggle.Button,
                })
                
                Toggle.Indicator = Create("Frame", {
                    Name = "Indicator",
                    Parent = Toggle.Button,
                    BackgroundColor3 = UILibrary.Theme.Text,
                    BorderSizePixel = 0,
                    Position = UDim2.new(0, 2, 0.5, 0),
                    AnchorPoint = Vector2.new(0, 0.5),
                    Size = UDim2.new(0, 16, 0, 16),
                })
                
                Create("UICorner", {
                    CornerRadius = UDim.new(1, 0),
                    Parent = Toggle.Indicator,
                })
                
                Toggle.Label = Create("TextLabel", {
                    Name = "Label",
                    Parent = Toggle.Container,
                    BackgroundTransparency = 1,
                    Position = UDim2.new(0, 50, 0, 0),
                    Size = UDim2.new(1, -50, 1, 0),
                    Font = UILibrary.Font,
                    Text = config.Name or "Toggle",
                    TextColor3 = UILibrary.Theme.Text,
                    TextSize = 11,
                    TextXAlignment = Enum.TextXAlignment.Left,
                })
                
                function Toggle:Set(value)
                    Toggle.Value = value
                    
                    if Toggle.Flag then
                        UILibrary.Flags[Toggle.Flag] = value
                    end
                    
                    if value then
                        Tween(Toggle.Button, {BackgroundColor3 = UILibrary.Theme.Accent})
                        Tween(Toggle.Indicator, {Position = UDim2.new(1, -18, 0.5, 0)})
                    else
                        Tween(Toggle.Button, {BackgroundColor3 = UILibrary.Theme.Inline})
                        Tween(Toggle.Indicator, {Position = UDim2.new(0, 2, 0.5, 0)})
                    end
                    
                    if config.Callback then
                        pcall(config.Callback, value)
                    end
                end
                
                Toggle.Button.MouseButton1Click:Connect(function()
                    Toggle:Set(not Toggle.Value)
                end)
                
                Toggle:Set(Toggle.Value)
                return Toggle
            end
            
            -- Create Slider
            function Section:CreateSlider(config)
                config = config or {}
                local Slider = {
                    Value = config.Default or config.Min or 0,
                    Min = config.Min or 0,
                    Max = config.Max or 100,
                    Decimals = config.Decimals or 1,
                    Flag = config.Flag,
                    Dragging = false,
                }
                
                Slider.Container = Create("Frame", {
                    Name = "Slider",
                    Parent = Section.ElementContainer,
                    BackgroundTransparency = 1,
                    Size = UDim2.new(1, 0, 0, 40),
                })
                
                Slider.Label = Create("TextLabel", {
                    Name = "Label",
                    Parent = Slider.Container,
                    BackgroundTransparency = 1,
                    Size = UDim2.new(1, -50, 0, 15),
                    Font = UILibrary.Font,
                    Text = config.Name or "Slider",
                    TextColor3 = UILibrary.Theme.Text,
                    TextSize = 11,
                    TextXAlignment = Enum.TextXAlignment.Left,
                })
                
                Slider.ValueLabel = Create("TextLabel", {
                    Name = "Value",
                    Parent = Slider.Container,
                    BackgroundTransparency = 1,
                    Position = UDim2.new(1, -50, 0, 0),
                    Size = UDim2.new(0, 50, 0, 15),
                    Font = UILibrary.Font,
                    Text = tostring(Slider.Value),
                    TextColor3 = UILibrary.Theme.Accent,
                    TextSize = 11,
                    TextXAlignment = Enum.TextXAlignment.Right,
                })
                
                Slider.Track = Create("Frame", {
                    Name = "Track",
                    Parent = Slider.Container,
                    BackgroundColor3 = UILibrary.Theme.Inline,
                    BorderSizePixel = 0,
                    Position = UDim2.new(0, 0, 1, -15),
                    Size = UDim2.new(1, 0, 0, 6),
                })
                
                Create("UICorner", {
                    CornerRadius = UDim.new(1, 0),
                    Parent = Slider.Track,
                })
                
                Slider.Fill = Create("Frame", {
                    Name = "Fill",
                    Parent = Slider.Track,
                    BackgroundColor3 = UILibrary.Theme.Accent,
                    BorderSizePixel = 0,
                    Size = UDim2.new(0.5, 0, 1, 0),
                })
                
                Create("UICorner", {
                    CornerRadius = UDim.new(1, 0),
                    Parent = Slider.Fill,
                })
                
                Slider.Button = Create("TextButton", {
                    Name = "Button",
                    Parent = Slider.Track,
                    BackgroundTransparency = 1,
                    Size = UDim2.new(1, 0, 1, 0),
                    Text = "",
                })
                
                function Slider:Set(value)
                    value = math.clamp(value, Slider.Min, Slider.Max)
                    value = math.floor(value * (10 ^ Slider.Decimals)) / (10 ^ Slider.Decimals)
                    Slider.Value = value
                    
                    if Slider.Flag then
                        UILibrary.Flags[Slider.Flag] = value
                    end
                    
                    local percent = (value - Slider.Min) / (Slider.Max - Slider.Min)
                    Tween(Slider.Fill, {Size = UDim2.new(percent, 0, 1, 0)})
                    Slider.ValueLabel.Text = tostring(value) .. (config.Suffix or "")
                    
                    if config.Callback then
                        pcall(config.Callback, value)
                    end
                end
                
                local function UpdateSlider(input)
                    local sizeX = math.clamp((input.Position.X - Slider.Track.AbsolutePosition.X) / Slider.Track.AbsoluteSize.X, 0, 1)
                    local value = Slider.Min + (Slider.Max - Slider.Min) * sizeX
                    Slider:Set(value)
                end
                
                Slider.Button.InputBegan:Connect(function(input)
                    if input.UserInputType == Enum.UserInputType.MouseButton1 or input.UserInputType == Enum.UserInputType.Touch then
                        Slider.Dragging = true
                        UpdateSlider(input)
                    end
                end)
                
                UserInputService.InputEnded:Connect(function(input)
                    if input.UserInputType == Enum.UserInputType.MouseButton1 or input.UserInputType == Enum.UserInputType.Touch then
                        Slider.Dragging = false
                    end
                end)
                
                UserInputService.InputChanged:Connect(function(input)
                    if Slider.Dragging and (input.UserInputType == Enum.UserInputType.MouseMovement or input.UserInputType == Enum.UserInputType.Touch) then
                        UpdateSlider(input)
                    end
                end)
                
                Slider:Set(Slider.Value)
                return Slider
            end
            
            -- Create Button
            function Section:CreateButton(config)
                config = config or {}
                local Button = {}
                
                Button.Container = Create("TextButton", {
                    Name = "Button",
                    Parent = Section.ElementContainer,
                    BackgroundColor3 = UILibrary.Theme.Inline,
                    BorderSizePixel = 0,
                    Size = UDim2.new(1, 0, 0, 30),
                    AutoButtonColor = false,
                    Font = UILibrary.Font,
                    Text = config.Name or "Button",
                    TextColor3 = UILibrary.Theme.Text,
                    TextSize = 11,
                })
                
                Create("UICorner", {
                    CornerRadius = UDim.new(0, 4),
                    Parent = Button.Container,
                })
                
                Button.Container.MouseButton1Click:Connect(function()
                    if config.Callback then
                        pcall(config.Callback)
                    end
                end)
                
                Button.Container.MouseEnter:Connect(function()
                    Tween(Button.Container, {BackgroundColor3 = UILibrary.Theme.ElementHover})
                end)
                
                Button.Container.MouseLeave:Connect(function()
                    Tween(Button.Container, {BackgroundColor3 = UILibrary.Theme.Inline})
                end)
                
                return Button
            end
            
            -- Create Dropdown
            function Section:CreateDropdown(config)
                config = config or {}
                local Dropdown = {
                    Value = config.Default or (config.Multi and {} or ""),
                    Options = config.Options or {},
                    Multi = config.Multi or false,
                    Flag = config.Flag,
                    Open = false,
                }
                
                Dropdown.Container = Create("Frame", {
                    Name = "Dropdown",
                    Parent = Section.ElementContainer,
                    BackgroundTransparency = 1,
                    Size = UDim2.new(1, 0, 0, 45),
                    ClipsDescendants = false,
                })
                
                Dropdown.Label = Create("TextLabel", {
                    Name = "Label",
                    Parent = Dropdown.Container,
                    BackgroundTransparency = 1,
                    Size = UDim2.new(1, 0, 0, 15),
                    Font = UILibrary.Font,
                    Text = config.Name or "Dropdown",
                    TextColor3 = UILibrary.Theme.Text,
                    TextSize = 11,
                    TextXAlignment = Enum.TextXAlignment.Left,
                })
                
                Dropdown.Button = Create("TextButton", {
                    Name = "Button",
                    Parent = Dropdown.Container,
                    BackgroundColor3 = UILibrary.Theme.Inline,
                    BorderSizePixel = 0,
                    Position = UDim2.new(0, 0, 0, 20),
                    Size = UDim2.new(1, 0, 0, 25),
                    AutoButtonColor = false,
                    Font = UILibrary.Font,
                    Text = "",
                    TextColor3 = UILibrary.Theme.Text,
                    TextSize = 10,
                })
                
                Create("UICorner", {
                    CornerRadius = UDim.new(0, 4),
                    Parent = Dropdown.Button,
                })
                
                Dropdown.ValueLabel = Create("TextLabel", {
                    Name = "ValueLabel",
                    Parent = Dropdown.Button,
                    BackgroundTransparency = 1,
                    Position = UDim2.new(0, 10, 0, 0),
                    Size = UDim2.new(1, -30, 1, 0),
                    Font = UILibrary.Font,
                    Text = "None",
                    TextColor3 = UILibrary.Theme.PlaceholderText,
                    TextSize = 10,
                    TextXAlignment = Enum.TextXAlignment.Left,
                })
                
                Dropdown.Arrow = Create("TextLabel", {
                    Name = "Arrow",
                    Parent = Dropdown.Button,
                    BackgroundTransparency = 1,
                    Position = UDim2.new(1, -20, 0, 0),
                    Size = UDim2.new(0, 20, 1, 0),
                    Font = UILibrary.Font,
                    Text = "â–¼",
                    TextColor3 = UILibrary.Theme.Accent,
                    TextSize = 10,
                })
                
                Dropdown.OptionsContainer = Create("Frame", {
                    Name = "Options",
                    Parent = Dropdown.Container,
                    BackgroundColor3 = UILibrary.Theme.Element,
                    BorderSizePixel = 0,
                    Position = UDim2.new(0, 0, 0, 50),
                    Size = UDim2.new(1, 0, 0, 0),
                    ClipsDescendants = true,
                    Visible = false,
                    ZIndex = 10,
                })
                
                Create("UICorner", {
                    CornerRadius = UDim.new(0, 4),
                    Parent = Dropdown.OptionsContainer,
                })
                
                Create("UIStroke", {
                    Color = UILibrary.Theme.Border,
                    Thickness = 1,
                    Parent = Dropdown.OptionsContainer,
                })
                
                Dropdown.OptionsList = Create("ScrollingFrame", {
                    Name = "List",
                    Parent = Dropdown.OptionsContainer,
                    Active = true,
                    BackgroundTransparency = 1,
                    BorderSizePixel = 0,
                    Size = UDim2.new(1, 0, 1, 0),
                    ScrollBarThickness = 2,
                    ScrollBarImageColor3 = UILibrary.Theme.Accent,
                    CanvasSize = UDim2.new(0, 0, 0, 0),
                    AutomaticCanvasSize = Enum.AutomaticSize.Y,
                })
                
                Create("UIListLayout", {
                    Parent = Dropdown.OptionsList,
                    SortOrder = Enum.SortOrder.LayoutOrder,
                    Padding = UDim.new(0, 2),
                })
                
                Create("UIPadding", {
                    Parent = Dropdown.OptionsList,
                    PaddingTop = UDim.new(0, 5),
                    PaddingLeft = UDim.new(0, 5),
                    PaddingRight = UDim.new(0, 5),
                    PaddingBottom = UDim.new(0, 5),
                })
                
                function Dropdown:Toggle()
                    Dropdown.Open = not Dropdown.Open
                    Dropdown.OptionsContainer.Visible = Dropdown.Open
                    
                    local targetSize = Dropdown.Open and math.min(#Dropdown.Options * 25 + 10, 150) or 0
                    Tween(Dropdown.OptionsContainer, {Size = UDim2.new(1, 0, 0, targetSize)}, 0.15)
                    Tween(Dropdown.Arrow, {Rotation = Dropdown.Open and 180 or 0}, 0.15)
                    
                    if Dropdown.Open then
                        Dropdown.Container.Size = UDim2.new(1, 0, 0, 55 + targetSize)
                    else
                        Dropdown.Container.Size = UDim2.new(1, 0, 0, 45)
                    end
                end
                
                function Dropdown:Set(value)
                    if Dropdown.Multi then
                        if type(value) == "table" then
                            Dropdown.Value = value
                        end
                    else
                        Dropdown.Value = value
                    end
                    
                    if Dropdown.Flag then
                        UILibrary.Flags[Dropdown.Flag] = Dropdown.Value
                    end
                    
                    -- Update display
                    if Dropdown.Multi then
                        Dropdown.ValueLabel.Text = #Dropdown.Value > 0 and table.concat(Dropdown.Value, ", ") or "None"
                    else
                        Dropdown.ValueLabel.Text = Dropdown.Value ~= "" and Dropdown.Value or "None"
                    end
                    
                    if config.Callback then
                        pcall(config.Callback, Dropdown.Value)
                    end
                end
                
                function Dropdown:Refresh(options)
                    for _, child in pairs(Dropdown.OptionsList:GetChildren()) do
                        if child:IsA("TextButton") then
                            child:Destroy()
                        end
                    end
                    
                    Dropdown.Options = options
                    
                    for _, option in pairs(options) do
                        local optionButton = Create("TextButton", {
                            Name = option,
                            Parent = Dropdown.OptionsList,
                            BackgroundColor3 = UILibrary.Theme.Inline,
                            BorderSizePixel = 0,
                            Size = UDim2.new(1, 0, 0, 25),
                            AutoButtonColor = false,
                            Font = UILibrary.Font,
                            Text = option,
                            TextColor3 = UILibrary.Theme.Text,
                            TextSize = 10,
                        })
                        
                        Create("UICorner", {
                            CornerRadius = UDim.new(0, 3),
                            Parent = optionButton,
                        })
                        
                        optionButton.MouseButton1Click:Connect(function()
                            if Dropdown.Multi then
                                local index = table.find(Dropdown.Value, option)
                                if index then
                                    table.remove(Dropdown.Value, index)
                                    Tween(optionButton, {BackgroundColor3 = UILibrary.Theme.Inline})
                                else
                                    table.insert(Dropdown.Value, option)
                                    Tween(optionButton, {BackgroundColor3 = UILibrary.Theme.Accent})
                                end
                                Dropdown:Set(Dropdown.Value)
                            else
                                Dropdown:Set(option)
                                Dropdown:Toggle()
                            end
                        end)
                        
                        optionButton.MouseEnter:Connect(function()
                            if Dropdown.Multi then
                                if not table.find(Dropdown.Value, option) then
                                    Tween(optionButton, {BackgroundColor3 = UILibrary.Theme.ElementHover})
                                end
                            else
                                if Dropdown.Value ~= option then
                                    Tween(optionButton, {BackgroundColor3 = UILibrary.Theme.ElementHover})
                                end
                            end
                        end)
                        
                        optionButton.MouseLeave:Connect(function()
                            if Dropdown.Multi then
                                if not table.find(Dropdown.Value, option) then
                                    Tween(optionButton, {BackgroundColor3 = UILibrary.Theme.Inline})
                                end
                            else
                                if Dropdown.Value ~= option then
                                    Tween(optionButton, {BackgroundColor3 = UILibrary.Theme.Inline})
                                end
                            end
                        end)
                    end
                end
                
                Dropdown.Button.MouseButton1Click:Connect(function()
                    Dropdown:Toggle()
                end)
                
                Dropdown:Refresh(Dropdown.Options)
                Dropdown:Set(Dropdown.Value)
                
                return Dropdown
            end
            
            -- Create Textbox
            function Section:CreateTextbox(config)
                config = config or {}
                local Textbox = {
                    Value = config.Default or "",
                    Flag = config.Flag,
                }
                
                Textbox.Container = Create("Frame", {
                    Name = "Textbox",
                    Parent = Section.ElementContainer,
                    BackgroundTransparency = 1,
                    Size = UDim2.new(1, 0, 0, 45),
                })
                
                Textbox.Label = Create("TextLabel", {
                    Name = "Label",
                    Parent = Textbox.Container,
                    BackgroundTransparency = 1,
                    Size = UDim2.new(1, 0, 0, 15),
                    Font = UILibrary.Font,
                    Text = config.Name or "Textbox",
                    TextColor3 = UILibrary.Theme.Text,
                    TextSize = 11,
                    TextXAlignment = Enum.TextXAlignment.Left,
                })
                
                Textbox.Input = Create("TextBox", {
                    Name = "Input",
                    Parent = Textbox.Container,
                    BackgroundColor3 = UILibrary.Theme.Inline,
                    BorderSizePixel = 0,
                    Position = UDim2.new(0, 0, 0, 20),
                    Size = UDim2.new(1, 0, 0, 25),
                    Font = UILibrary.Font,
                    PlaceholderText = config.Placeholder or "Enter text...",
                    PlaceholderColor3 = UILibrary.Theme.PlaceholderText,
                    Text = Textbox.Value,
                    TextColor3 = UILibrary.Theme.Text,
                    TextSize = 10,
                    ClearTextOnFocus = false,
                })
                
                Create("UICorner", {
                    CornerRadius = UDim.new(0, 4),
                    Parent = Textbox.Input,
                })
                
                Create("UIPadding", {
                    Parent = Textbox.Input,
                    PaddingLeft = UDim.new(0, 10),
                    PaddingRight = UDim.new(0, 10),
                })
                
                function Textbox:Set(value)
                    Textbox.Value = value
                    Textbox.Input.Text = value
                    
                    if Textbox.Flag then
                        UILibrary.Flags[Textbox.Flag] = value
                    end
                    
                    if config.Callback then
                        pcall(config.Callback, value)
                    end
                end
                
                Textbox.Input.FocusLost:Connect(function()
                    Textbox:Set(Textbox.Input.Text)
                end)
                
                return Textbox
            end
            
            table.insert(Page.Sections, Section)
            return Section
        end
        
        table.insert(Window.Pages, Page)
        
        if #Window.Pages == 1 then
            Page:SetActive(true)
        end
        
        return Page
    end
    
    function Window:Toggle()
        Window.Visible = not Window.Visible
        Window.Main.Visible = Window.Visible
    end
    
    function Window:Destroy()
        Window.ScreenGui:Destroy()
        getgenv().UILibrary = nil
    end
    
    getgenv().UILibrary = Window
    return Window
end

-- Notification System
function UILibrary:Notify(config)
    config = config or {}
    local duration = config.Duration or 3
    
    local NotifGui = Create("ScreenGui", {
        Name = HttpService:GenerateGUID(false),
        Parent = GetCoreGui(),
        ZIndexBehavior = Enum.ZIndexBehavior.Sibling,
        ResetOnSpawn = false,
    })
    
    local Notification = Create("Frame", {
        Name = "Notification",
        Parent = NotifGui,
        BackgroundColor3 = UILibrary.Theme.Background,
        BorderSizePixel = 0,
        Position = UDim2.new(1, -320, 1, 50),
        Size = UDim2.new(0, 300, 0, 0),
        AutomaticSize = Enum.AutomaticSize.Y,
    })
    
    Create("UICorner", {
        CornerRadius = UDim.new(0, 6),
        Parent = Notification,
    })
    
    Create("UIStroke", {
        Color = UILibrary.Theme.Accent,
        Thickness = 2,
        Parent = Notification,
    })
    
    local Title = Create("TextLabel", {
        Name = "Title",
        Parent = Notification,
        BackgroundTransparency = 1,
        Position = UDim2.new(0, 15, 0, 10),
        Size = UDim2.new(1, -30, 0, 20),
        Font = UILibrary.Font,
        Text = config.Title or "Notification",
        TextColor3 = UILibrary.Theme.Accent,
        TextSize = 13,
        TextXAlignment = Enum.TextXAlignment.Left,
    })
    
    local Description = Create("TextLabel", {
        Name = "Description",
        Parent = Notification,
        BackgroundTransparency = 1,
        Position = UDim2.new(0, 15, 0, 35),
        Size = UDim2.new(1, -30, 0, 0),
        Font = Font.fromEnum(Enum.Font.Gotham),
        Text = config.Description or "Description",
        TextColor3 = UILibrary.Theme.Text,
        TextSize = 11,
        TextWrapped = true,
        TextXAlignment = Enum.TextXAlignment.Left,
        TextYAlignment = Enum.TextYAlignment.Top,
        AutomaticSize = Enum.AutomaticSize.Y,
    })
    
    Create("UIPadding", {
        Parent = Description,
        PaddingBottom = UDim.new(0, 10),
    })
    
    Tween(Notification, {Position = UDim2.new(1, -320, 1, -70)}, 0.5, Enum.EasingStyle.Back)
    
    task.delay(duration, function()
        Tween(Notification, {Position = UDim2.new(1, -320, 1, 50)}, 0.5, Enum.EasingStyle.Quad)
        task.wait(0.5)
        NotifGui:Destroy()
    end)
end

return UILibrary
