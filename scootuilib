-- DOLLARWARE UI LIBRARY v2.0 - Enhanced Edition
-- Modern CSGO-inspired UI with automatic settings saving

local DollarwareLib = {}
local HttpService = game:GetService("HttpService")
local TweenService = game:GetService("TweenService")
local UserInputService = game:GetService("UserInputService")
local RunService = game:GetService("RunService")
local CoreGui = game:GetService("CoreGui")

-- Configuration
local CONFIG_FOLDER = "DollarwareV2"
local CONFIG_FILE = "settings.json"

-- Color schemes (CSGO-inspired)
local themes = {
    csgo = {
        primary = Color3.fromRGB(30, 30, 35),
        secondary = Color3.fromRGB(40, 40, 45),
        accent = Color3.fromRGB(102, 187, 106),
        hover = Color3.fromRGB(50, 50, 55),
        text = Color3.fromRGB(230, 230, 235),
        textDim = Color3.fromRGB(160, 160, 165),
        border = Color3.fromRGB(60, 60, 65),
        danger = Color3.fromRGB(229, 115, 115),
        warning = Color3.fromRGB(255, 193, 7)
    },
    purple = {
        primary = Color3.fromRGB(25, 20, 40),
        secondary = Color3.fromRGB(35, 30, 50),
        accent = Color3.fromRGB(138, 102, 204),
        hover = Color3.fromRGB(45, 40, 60),
        text = Color3.fromRGB(230, 230, 235),
        textDim = Color3.fromRGB(160, 160, 165),
        border = Color3.fromRGB(70, 60, 90),
        danger = Color3.fromRGB(229, 115, 115),
        warning = Color3.fromRGB(255, 193, 7)
    },
    blue = {
        primary = Color3.fromRGB(20, 25, 40),
        secondary = Color3.fromRGB(30, 35, 50),
        accent = Color3.fromRGB(66, 165, 245),
        hover = Color3.fromRGB(40, 45, 60),
        text = Color3.fromRGB(230, 230, 235),
        textDim = Color3.fromRGB(160, 160, 165),
        border = Color3.fromRGB(60, 70, 90),
        danger = Color3.fromRGB(229, 115, 115),
        warning = Color3.fromRGB(255, 193, 7)
    },
    red = {
        primary = Color3.fromRGB(35, 20, 20),
        secondary = Color3.fromRGB(45, 30, 30),
        accent = Color3.fromRGB(239, 83, 80),
        hover = Color3.fromRGB(55, 40, 40),
        text = Color3.fromRGB(230, 230, 235),
        textDim = Color3.fromRGB(160, 160, 165),
        border = Color3.fromRGB(80, 60, 60),
        danger = Color3.fromRGB(229, 115, 115),
        warning = Color3.fromRGB(255, 193, 7)
    }
}

-- Settings storage
local savedSettings = {}

-- Utility functions
local function loadSettings()
    if not isfolder(CONFIG_FOLDER) then
        makefolder(CONFIG_FOLDER)
    end
    
    local filePath = CONFIG_FOLDER .. "/" .. CONFIG_FILE
    if isfile(filePath) then
        local success, data = pcall(function()
            return HttpService:JSONDecode(readfile(filePath))
        end)
        if success then
            savedSettings = data
            return true
        end
    end
    return false
end

local function saveSettings()
    if not isfolder(CONFIG_FOLDER) then
        makefolder(CONFIG_FOLDER)
    end
    
    local filePath = CONFIG_FOLDER .. "/" .. CONFIG_FILE
    local success = pcall(function()
        writefile(filePath, HttpService:JSONEncode(savedSettings))
    end)
    return success
end

local function getSetting(key, default)
    if savedSettings[key] ~= nil then
        return savedSettings[key]
    end
    return default
end

local function setSetting(key, value)
    savedSettings[key] = value
    saveSettings()
end

local function tween(object, properties, duration, style, direction)
    local tweenInfo = TweenInfo.new(
        duration or 0.3,
        style or Enum.EasingStyle.Quad,
        direction or Enum.EasingDirection.Out
    )
    local tween = TweenService:Create(object, tweenInfo, properties)
    tween:Play()
    return tween
end

local function createCorner(parent, radius)
    local corner = Instance.new("UICorner")
    corner.CornerRadius = UDim.new(0, radius or 6)
    corner.Parent = parent
    return corner
end

local function createStroke(parent, color, thickness)
    local stroke = Instance.new("UIStroke")
    stroke.Color = color
    stroke.Thickness = thickness or 1
    stroke.ApplyStrokeMode = Enum.ApplyStrokeMode.Border
    stroke.Parent = parent
    return stroke
end

local function createGradient(parent, colors, rotation)
    local gradient = Instance.new("UIGradient")
    
    local colorSequence = ColorSequence.new(colors)
    gradient.Color = colorSequence
    gradient.Rotation = rotation or 0
    gradient.Parent = parent
    return gradient
end

-- Initialize settings
loadSettings()

-- Main library functions
function DollarwareLib.new(options)
    options = options or {}
    
    local themeName = getSetting("theme", options.theme or "csgo")
    local theme = themes[themeName] or themes.csgo
    
    local lib = {
        theme = theme,
        themeName = themeName,
        windows = {},
        notifications = {}
    }
    
    -- Create ScreenGui
    local screenGui = Instance.new("ScreenGui")
    screenGui.Name = "DollarwareV2_" .. HttpService:GenerateGUID(false)
    screenGui.ResetOnSpawn = false
    screenGui.ZIndexBehavior = Enum.ZIndexBehavior.Sibling
    
    if syn and syn.protect_gui then
        syn.protect_gui(screenGui)
        screenGui.Parent = CoreGui
    elseif gethui then
        screenGui.Parent = gethui()
    else
        screenGui.Parent = CoreGui
    end
    
    lib.screenGui = screenGui
    
    -- Notification system
    function lib:notify(options)
        options = options or {}
        local title = options.title or "Notification"
        local message = options.message or ""
        local duration = options.duration or 3
        local type = options.type or "info" -- info, success, warning, error
        
        local notifFrame = Instance.new("Frame")
        notifFrame.Size = UDim2.new(0, 300, 0, 80)
        notifFrame.Position = UDim2.new(1, -320, 1, 100)
        notifFrame.BackgroundColor3 = theme.secondary
        notifFrame.BorderSizePixel = 0
        notifFrame.Parent = screenGui
        
        createCorner(notifFrame, 8)
        createStroke(notifFrame, theme.border, 1)
        
        -- Color indicator
        local indicator = Instance.new("Frame")
        indicator.Size = UDim2.new(0, 4, 1, 0)
        indicator.Position = UDim2.new(0, 0, 0, 0)
        indicator.BorderSizePixel = 0
        indicator.Parent = notifFrame
        
        if type == "success" then
            indicator.BackgroundColor3 = theme.accent
        elseif type == "warning" then
            indicator.BackgroundColor3 = theme.warning
        elseif type == "error" then
            indicator.BackgroundColor3 = theme.danger
        else
            indicator.BackgroundColor3 = theme.accent
        end
        
        createCorner(indicator, 8)
        
        -- Title
        local titleLabel = Instance.new("TextLabel")
        titleLabel.Size = UDim2.new(1, -20, 0, 25)
        titleLabel.Position = UDim2.new(0, 15, 0, 8)
        titleLabel.BackgroundTransparency = 1
        titleLabel.Text = title
        titleLabel.TextColor3 = theme.text
        titleLabel.TextSize = 14
        titleLabel.Font = Enum.Font.GothamBold
        titleLabel.TextXAlignment = Enum.TextXAlignment.Left
        titleLabel.Parent = notifFrame
        
        -- Message
        local messageLabel = Instance.new("TextLabel")
        messageLabel.Size = UDim2.new(1, -20, 0, 40)
        messageLabel.Position = UDim2.new(0, 15, 0, 33)
        messageLabel.BackgroundTransparency = 1
        messageLabel.Text = message
        messageLabel.TextColor3 = theme.textDim
        messageLabel.TextSize = 12
        messageLabel.Font = Enum.Font.Gotham
        messageLabel.TextXAlignment = Enum.TextXAlignment.Left
        messageLabel.TextYAlignment = Enum.TextYAlignment.Top
        messageLabel.TextWrapped = true
        messageLabel.Parent = notifFrame
        
        -- Animate in
        local targetPos = UDim2.new(1, -320, 1, -(#self.notifications * 90 + 20))
        tween(notifFrame, {Position = targetPos}, 0.5, Enum.EasingStyle.Back, Enum.EasingDirection.Out)
        
        table.insert(self.notifications, notifFrame)
        
        -- Auto dismiss
        task.delay(duration, function()
            tween(notifFrame, {
                Position = UDim2.new(1, 0, notifFrame.Position.Y.Scale, notifFrame.Position.Y.Offset)
            }, 0.3)
            
            task.wait(0.3)
            
            for i, notif in ipairs(self.notifications) do
                if notif == notifFrame then
                    table.remove(self.notifications, i)
                    break
                end
            end
            
            notifFrame:Destroy()
            
            -- Reposition remaining notifications
            for i, notif in ipairs(self.notifications) do
                tween(notif, {
                    Position = UDim2.new(1, -320, 1, -(i * 90 + 20))
                }, 0.3)
            end
        end)
    end
    
    -- Create window
    function lib:createWindow(options)
        options = options or {}
        local windowName = options.name or "Dollarware V2"
        local size = options.size or Vector2.new(600, 400)
        
        local window = {
            tabs = {},
            currentTab = nil,
            minimized = false
        }
        
        -- Main window frame
        local windowFrame = Instance.new("Frame")
        windowFrame.Name = "DollarwareWindow"
        windowFrame.Size = UDim2.new(0, size.X, 0, size.Y)
        windowFrame.Position = getSetting("windowPos") or UDim2.new(0.5, -size.X/2, 0.5, -size.Y/2)
        windowFrame.BackgroundColor3 = theme.primary
        windowFrame.BorderSizePixel = 0
        windowFrame.ClipsDescendants = true
        windowFrame.Parent = screenGui
        
        createCorner(windowFrame, 10)
        createStroke(windowFrame, theme.border, 2)
        
        -- Add shadow effect
        local shadow = Instance.new("ImageLabel")
        shadow.Name = "Shadow"
        shadow.Size = UDim2.new(1, 30, 1, 30)
        shadow.Position = UDim2.new(0, -15, 0, -15)
        shadow.BackgroundTransparency = 1
        shadow.Image = "rbxassetid://5554236805"
        shadow.ImageColor3 = Color3.fromRGB(0, 0, 0)
        shadow.ImageTransparency = 0.5
        shadow.ScaleType = Enum.ScaleType.Slice
        shadow.SliceCenter = Rect.new(23, 23, 277, 277)
        shadow.ZIndex = 0
        shadow.Parent = windowFrame
        
        -- Title bar
        local titleBar = Instance.new("Frame")
        titleBar.Name = "TitleBar"
        titleBar.Size = UDim2.new(1, 0, 0, 50)
        titleBar.BackgroundColor3 = theme.secondary
        titleBar.BorderSizePixel = 0
        titleBar.Parent = windowFrame
        
        createCorner(titleBar, 10)
        
        -- Accent bar
        local accentBar = Instance.new("Frame")
        accentBar.Size = UDim2.new(1, 0, 0, 3)
        accentBar.Position = UDim2.new(0, 0, 0, 50)
        accentBar.BackgroundColor3 = theme.accent
        accentBar.BorderSizePixel = 0
        accentBar.Parent = windowFrame
        
        -- Title text
        local titleText = Instance.new("TextLabel")
        titleText.Size = UDim2.new(1, -100, 1, 0)
        titleText.Position = UDim2.new(0, 15, 0, 0)
        titleText.BackgroundTransparency = 1
        titleText.Text = windowName
        titleText.TextColor3 = theme.text
        titleText.TextSize = 18
        titleText.Font = Enum.Font.GothamBold
        titleText.TextXAlignment = Enum.TextXAlignment.Left
        titleText.Parent = titleBar
        
        -- Minimize button
        local minimizeBtn = Instance.new("TextButton")
        minimizeBtn.Size = UDim2.new(0, 40, 0, 40)
        minimizeBtn.Position = UDim2.new(1, -90, 0, 5)
        minimizeBtn.BackgroundColor3 = theme.hover
        minimizeBtn.BorderSizePixel = 0
        minimizeBtn.Text = "−"
        minimizeBtn.TextColor3 = theme.text
        minimizeBtn.TextSize = 20
        minimizeBtn.Font = Enum.Font.GothamBold
        minimizeBtn.Parent = titleBar
        
        createCorner(minimizeBtn, 6)
        
        -- Close button
        local closeBtn = Instance.new("TextButton")
        closeBtn.Size = UDim2.new(0, 40, 0, 40)
        closeBtn.Position = UDim2.new(1, -45, 0, 5)
        closeBtn.BackgroundColor3 = theme.danger
        closeBtn.BorderSizePixel = 0
        closeBtn.Text = "×"
        closeBtn.TextColor3 = theme.text
        closeBtn.TextSize = 24
        closeBtn.Font = Enum.Font.GothamBold
        closeBtn.Parent = titleBar
        
        createCorner(closeBtn, 6)
        
        -- Tab container
        local tabContainer = Instance.new("Frame")
        tabContainer.Name = "TabContainer"
        tabContainer.Size = UDim2.new(0, 150, 1, -53)
        tabContainer.Position = UDim2.new(0, 0, 0, 53)
        tabContainer.BackgroundColor3 = theme.secondary
        tabContainer.BorderSizePixel = 0
        tabContainer.Parent = windowFrame
        
        -- Tab list
        local tabList = Instance.new("ScrollingFrame")
        tabList.Size = UDim2.new(1, 0, 1, 0)
        tabList.BackgroundTransparency = 1
        tabList.BorderSizePixel = 0
        tabList.ScrollBarThickness = 4
        tabList.ScrollBarImageColor3 = theme.accent
        tabList.CanvasSize = UDim2.new(0, 0, 0, 0)
        tabList.Parent = tabContainer
        
        local tabListLayout = Instance.new("UIListLayout")
        tabListLayout.Padding = UDim.new(0, 5)
        tabListLayout.Parent = tabList
        
        tabListLayout:GetPropertyChangedSignal("AbsoluteContentSize"):Connect(function()
            tabList.CanvasSize = UDim2.new(0, 0, 0, tabListLayout.AbsoluteContentSize.Y + 10)
        end)
        
        -- Content area
        local contentArea = Instance.new("Frame")
        contentArea.Name = "ContentArea"
        contentArea.Size = UDim2.new(1, -150, 1, -53)
        contentArea.Position = UDim2.new(0, 150, 0, 53)
        contentArea.BackgroundTransparency = 1
        contentArea.Parent = windowFrame
        
        -- Dragging functionality
        local dragging, dragInput, dragStart, startPos
        
        titleBar.InputBegan:Connect(function(input)
            if input.UserInputType == Enum.UserInputType.MouseButton1 then
                dragging = true
                dragStart = input.Position
                startPos = windowFrame.Position
                
                input.Changed:Connect(function()
                    if input.UserInputState == Enum.UserInputState.End then
                        dragging = false
                        setSetting("windowPos", windowFrame.Position)
                    end
                end)
            end
        end)
        
        titleBar.InputChanged:Connect(function(input)
            if input.UserInputType == Enum.UserInputType.MouseMovement then
                dragInput = input
            end
        end)
        
        UserInputService.InputChanged:Connect(function(input)
            if input == dragInput and dragging then
                local delta = input.Position - dragStart
                windowFrame.Position = UDim2.new(
                    startPos.X.Scale,
                    startPos.X.Offset + delta.X,
                    startPos.Y.Scale,
                    startPos.Y.Offset + delta.Y
                )
            end
        end)
        
        -- Button hover effects
        minimizeBtn.MouseEnter:Connect(function()
            tween(minimizeBtn, {BackgroundColor3 = theme.accent}, 0.2)
        end)
        
        minimizeBtn.MouseLeave:Connect(function()
            tween(minimizeBtn, {BackgroundColor3 = theme.hover}, 0.2)
        end)
        
        closeBtn.MouseEnter:Connect(function()
            tween(closeBtn, {BackgroundColor3 = Color3.fromRGB(200, 60, 60)}, 0.2)
        end)
        
        closeBtn.MouseLeave:Connect(function()
            tween(closeBtn, {BackgroundColor3 = theme.danger}, 0.2)
        end)
        
        -- Button actions
        minimizeBtn.MouseButton1Click:Connect(function()
            window.minimized = not window.minimized
            local targetSize = window.minimized and UDim2.new(0, size.X, 0, 50) or UDim2.new(0, size.X, 0, size.Y)
            tween(windowFrame, {Size = targetSize}, 0.3, Enum.EasingStyle.Quad)
            minimizeBtn.Text = window.minimized and "+" or "−"
        end)
        
        closeBtn.MouseButton1Click:Connect(function()
            tween(windowFrame, {Size = UDim2.new(0, 0, 0, 0)}, 0.3)
            task.wait(0.3)
            screenGui:Destroy()
        end)
        
        -- Create tab function
        function window:createTab(tabName)
            local tab = {
                elements = {},
                visible = false
            }
            
            -- Tab button
            local tabBtn = Instance.new("TextButton")
            tabBtn.Size = UDim2.new(1, -10, 0, 40)
            tabBtn.BackgroundColor3 = theme.primary
            tabBtn.BorderSizePixel = 0
            tabBtn.Text = tabName
            tabBtn.TextColor3 = theme.textDim
            tabBtn.TextSize = 14
            tabBtn.Font = Enum.Font.GothamSemibold
            tabBtn.Parent = tabList
            
            createCorner(tabBtn, 6)
            
            -- Tab indicator
            local indicator = Instance.new("Frame")
            indicator.Size = UDim2.new(0, 3, 1, 0)
            indicator.Position = UDim2.new(0, 0, 0, 0)
            indicator.BackgroundColor3 = theme.accent
            indicator.BorderSizePixel = 0
            indicator.BackgroundTransparency = 1
            indicator.Parent = tabBtn
            
            createCorner(indicator, 6)
            
            -- Tab content
            local tabContent = Instance.new("ScrollingFrame")
            tabContent.Name = tabName
            tabContent.Size = UDim2.new(1, -20, 1, -10)
            tabContent.Position = UDim2.new(0, 10, 0, 5)
            tabContent.BackgroundTransparency = 1
            tabContent.BorderSizePixel = 0
            tabContent.ScrollBarThickness = 6
            tabContent.ScrollBarImageColor3 = theme.accent
            tabContent.CanvasSize = UDim2.new(0, 0, 0, 0)
            tabContent.Visible = false
            tabContent.Parent = contentArea
            
            local contentLayout = Instance.new("UIListLayout")
            contentLayout.Padding = UDim.new(0, 10)
            contentLayout.Parent = tabContent
            
            contentLayout:GetPropertyChangedSignal("AbsoluteContentSize"):Connect(function()
                tabContent.CanvasSize = UDim2.new(0, 0, 0, contentLayout.AbsoluteContentSize.Y + 10)
            end)
            
            tab.content = tabContent
            
            -- Tab button functionality
            tabBtn.MouseButton1Click:Connect(function()
                for _, t in pairs(window.tabs) do
                    t.visible = false
                    t.content.Visible = false
                    t.button.BackgroundColor3 = theme.primary
                    t.button.TextColor3 = theme.textDim
                    tween(t.indicator, {BackgroundTransparency = 1}, 0.2)
                end
                
                tab.visible = true
                tabContent.Visible = true
                tabBtn.BackgroundColor3 = theme.hover
                tabBtn.TextColor3 = theme.text
                tween(indicator, {BackgroundTransparency = 0}, 0.2)
                window.currentTab = tab
            end)
            
            tabBtn.MouseEnter:Connect(function()
                if not tab.visible then
                    tween(tabBtn, {BackgroundColor3 = theme.hover}, 0.2)
                end
            end)
            
            tabBtn.MouseLeave:Connect(function()
                if not tab.visible then
                    tween(tabBtn, {BackgroundColor3 = theme.primary}, 0.2)
                end
            end)
            
            tab.button = tabBtn
            tab.indicator = indicator
            
            -- Auto-select first tab
            if #window.tabs == 0 then
                tabBtn.BackgroundColor3 = theme.hover
                tabBtn.TextColor3 = theme.text
                indicator.BackgroundTransparency = 0
                tabContent.Visible = true
                tab.visible = true
                window.currentTab = tab
            end
            
            table.insert(window.tabs, tab)
            
            -- Tab elements
            function tab:addSection(sectionName)
                local sectionFrame = Instance.new("Frame")
                sectionFrame.Size = UDim2.new(1, 0, 0, 35)
                sectionFrame.BackgroundTransparency = 1
                sectionFrame.Parent = tabContent
                
                local sectionLabel = Instance.new("TextLabel")
                sectionLabel.Size = UDim2.new(1, 0, 1, 0)
                sectionLabel.BackgroundTransparency = 1
                sectionLabel.Text = sectionName
                sectionLabel.TextColor3 = theme.accent
                sectionLabel.TextSize = 16
                sectionLabel.Font = Enum.Font.GothamBold
                sectionLabel.TextXAlignment = Enum.TextXAlignment.Left
                sectionLabel.Parent = sectionFrame
                
                local divider = Instance.new("Frame")
                divider.Size = UDim2.new(1, 0, 0, 2)
                divider.Position = UDim2.new(0, 0, 1, -2)
                divider.BackgroundColor3 = theme.accent
                divider.BorderSizePixel = 0
                divider.BackgroundTransparency = 0.5
                divider.Parent = sectionFrame
                
                return sectionFrame
            end
            
            function tab:addButton(options)
                options = options or {}
                local buttonText = options.text or "Button"
                local callback = options.callback or function() end
                
                local buttonFrame = Instance.new("Frame")
                buttonFrame.Size = UDim2.new(1, 0, 0, 40)
                buttonFrame.BackgroundColor3 = theme.secondary
                buttonFrame.BorderSizePixel = 0
                buttonFrame.Parent = tabContent
                
                createCorner(buttonFrame, 6)
                createStroke(buttonFrame, theme.border, 1)
                
                local button = Instance.new("TextButton")
                button.Size = UDim2.new(1, -20, 1, -10)
                button.Position = UDim2.new(0, 10, 0, 5)
                button.BackgroundTransparency = 1
                button.Text = buttonText
                button.TextColor3 = theme.text
                button.TextSize = 14
                button.Font = Enum.Font.GothamSemibold
                button.Parent = buttonFrame
                
                button.MouseEnter:Connect(function()
                    tween(buttonFrame, {BackgroundColor3 = theme.hover}, 0.2)
                end)
                
                button.MouseLeave:Connect(function()
                    tween(buttonFrame, {BackgroundColor3 = theme.secondary}, 0.2)
                end)
                
                button.MouseButton1Click:Connect(function()
                    tween(buttonFrame, {BackgroundColor3 = theme.accent}, 0.1)
                    task.wait(0.1)
                    tween(buttonFrame, {BackgroundColor3 = theme.hover}, 0.1)
                    callback()
                end)
                
                return button
            end
            
            function tab:addToggle(options)
                options = options or {}
                local toggleText = options.text or "Toggle"
                local default = getSetting("toggle_" .. toggleText, options.default or false)
                local callback = options.callback or function() end
                
                local toggleFrame = Instance.new("Frame")
                toggleFrame.Size = UDim2.new(1, 0, 0, 40)
                toggleFrame.BackgroundColor3 = theme.secondary
                toggleFrame.BorderSizePixel = 0
                toggleFrame.Parent = tabContent
                
                createCorner(toggleFrame, 6)
                createStroke(toggleFrame, theme.border, 1)
                
                local label = Instance.new("TextLabel")
                label.Size = UDim2.new(1, -70, 1, 0)
                label.Position = UDim2.new(0, 15, 0, 0)
                label.BackgroundTransparency = 1
                label.Text = toggleText
                label.TextColor3 = theme.text
                label.TextSize = 14
                label.Font = Enum.Font.Gotham
                label.TextXAlignment = Enum.TextXAlignment.Left
                label.Parent = toggleFrame
                
                local toggleContainer = Instance.new("Frame")
                toggleContainer.Size = UDim2.new(0, 45, 0, 22)
                toggleContainer.Position = UDim2.new(1, -60, 0.5, -11)
                toggleContainer.BackgroundColor3 = default and theme.accent or theme.primary
                toggleContainer.BorderSizePixel = 0
                toggleContainer.Parent = toggleFrame
                
                createCorner(toggleContainer, 11)
                
                local toggleButton = Instance.new("Frame")
                toggleButton.Size = UDim2.new(0, 18, 0, 18)
                toggleButton.Position = default and UDim2.new(1, -20, 0.5, -9) or UDim2.new(0, 2, 0.5, -9)
                toggleButton.BackgroundColor3 = theme.text
                toggleButton.BorderSizePixel = 0
                toggleButton.Parent = toggleContainer
                
                createCorner(toggleButton, 9)
                
                local toggleBtn = Instance.new("TextButton")
                toggleBtn.Size = UDim2.new(1, 0, 1, 0)
                toggleBtn.BackgroundTransparency = 1
                toggleBtn.Text = ""
                toggleBtn.Parent = toggleFrame
                
                local toggled = default
                
                toggleBtn.MouseButton1Click:Connect(function()
                    toggled = not toggled
                    
                    setSetting("toggle_" .. toggleText, toggled)
                    
                    tween(toggleContainer, {
                        BackgroundColor3 = toggled and theme.accent or theme.primary
                    }, 0.2)
                    
                    tween(toggleButton, {
                        Position = toggled and UDim2.new(1, -20, 0.5, -9) or UDim2.new(0, 2, 0.5, -9)
                    }, 0.2, Enum.EasingStyle.Quad)
                    
                    callback(toggled)
                end)
                
                toggleFrame.MouseEnter:Connect(function()
                    tween(toggleFrame, {BackgroundColor3 = theme.hover}, 0.2)
                end)
                
                toggleFrame.MouseLeave:Connect(function()
                    tween(toggleFrame, {BackgroundColor3 = theme.secondary}, 0.2)
                end)
                
                -- Return toggle object with methods
                return {
                    set = function(value)
                        toggled = value
                        setSetting("toggle_" .. toggleText, value)
                        toggleContainer.BackgroundColor3 = value and theme.accent or theme.primary
                        toggleButton.Position = value and UDim2.new(1, -20, 0.5, -9) or UDim2.new(0, 2, 0.5, -9)
                    end,
                    get = function()
                        return toggled
                    end
                }
            end
            
            function tab:addSlider(options)
                options = options or {}
                local sliderText = options.text or "Slider"
                local min = options.min or 0
                local max = options.max or 100
                local default = getSetting("slider_" .. sliderText, options.default or min)
                local increment = options.increment or 1
                local callback = options.callback or function() end
                
                local sliderFrame = Instance.new("Frame")
                sliderFrame.Size = UDim2.new(1, 0, 0, 55)
                sliderFrame.BackgroundColor3 = theme.secondary
                sliderFrame.BorderSizePixel = 0
                sliderFrame.Parent = tabContent
                
                createCorner(sliderFrame, 6)
                createStroke(sliderFrame, theme.border, 1)
                
                local label = Instance.new("TextLabel")
                label.Size = UDim2.new(1, -80, 0, 20)
                label.Position = UDim2.new(0, 15, 0, 8)
                label.BackgroundTransparency = 1
                label.Text = sliderText
                label.TextColor3 = theme.text
                label.TextSize = 14
                label.Font = Enum.Font.Gotham
                label.TextXAlignment = Enum.TextXAlignment.Left
                label.Parent = sliderFrame
                
                local valueLabel = Instance.new("TextLabel")
                valueLabel.Size = UDim2.new(0, 60, 0, 20)
                valueLabel.Position = UDim2.new(1, -70, 0, 8)
                valueLabel.BackgroundTransparency = 1
                valueLabel.Text = tostring(default)
                valueLabel.TextColor3 = theme.accent
                valueLabel.TextSize = 14
                valueLabel.Font = Enum.Font.GothamBold
                valueLabel.TextXAlignment = Enum.TextXAlignment.Right
                valueLabel.Parent = sliderFrame
                
                local sliderBack = Instance.new("Frame")
                sliderBack.Size = UDim2.new(1, -30, 0, 6)
                sliderBack.Position = UDim2.new(0, 15, 1, -18)
                sliderBack.BackgroundColor3 = theme.primary
                sliderBack.BorderSizePixel = 0
                sliderBack.Parent = sliderFrame
                
                createCorner(sliderBack, 3)
                
                local sliderFill = Instance.new("Frame")
                sliderFill.Size = UDim2.new((default - min) / (max - min), 0, 1, 0)
                sliderFill.BackgroundColor3 = theme.accent
                sliderFill.BorderSizePixel = 0
                sliderFill.Parent = sliderBack
                
                createCorner(sliderFill, 3)
                
                local sliderButton = Instance.new("TextButton")
                sliderButton.Size = UDim2.new(1, 0, 1, 0)
                sliderButton.BackgroundTransparency = 1
                sliderButton.Text = ""
                sliderButton.Parent = sliderBack
                
                local dragging = false
                
                sliderButton.MouseButton1Down:Connect(function()
                    dragging = true
                end)
                
                UserInputService.InputEnded:Connect(function(input)
                    if input.UserInputType == Enum.UserInputType.MouseButton1 then
                        dragging = false
                    end
                end)
                
                sliderButton.MouseMoved:Connect(function(x)
                    if dragging then
                        local pos = math.clamp((x - sliderBack.AbsolutePosition.X) / sliderBack.AbsoluteSize.X, 0, 1)
                        local value = math.floor((min + (max - min) * pos) / increment + 0.5) * increment
                        
                        sliderFill.Size = UDim2.new(pos, 0, 1, 0)
                        valueLabel.Text = tostring(value)
                        
                        setSetting("slider_" .. sliderText, value)
                        callback(value)
                    end
                end)
                
                sliderFrame.MouseEnter:Connect(function()
                    tween(sliderFrame, {BackgroundColor3 = theme.hover}, 0.2)
                end)
                
                sliderFrame.MouseLeave:Connect(function()
                    tween(sliderFrame, {BackgroundColor3 = theme.secondary}, 0.2)
                end)
                
                return {
                    set = function(value)
                        value = math.clamp(value, min, max)
                        local pos = (value - min) / (max - min)
                        sliderFill.Size = UDim2.new(pos, 0, 1, 0)
                        valueLabel.Text = tostring(value)
                        setSetting("slider_" .. sliderText, value)
                    end,
                    get = function()
                        return tonumber(valueLabel.Text)
                    end
                }
            end
            
            function tab:addDropdown(options)
                options = options or {}
                local dropdownText = options.text or "Dropdown"
                local items = options.items or {}
                local default = getSetting("dropdown_" .. dropdownText, options.default or (items[1] or ""))
                local callback = options.callback or function() end
                
                local dropdownFrame = Instance.new("Frame")
                dropdownFrame.Size = UDim2.new(1, 0, 0, 40)
                dropdownFrame.BackgroundColor3 = theme.secondary
                dropdownFrame.BorderSizePixel = 0
                dropdownFrame.Parent = tabContent
                
                createCorner(dropdownFrame, 6)
                createStroke(dropdownFrame, theme.border, 1)
                
                local label = Instance.new("TextLabel")
                label.Size = UDim2.new(1, -150, 1, 0)
                label.Position = UDim2.new(0, 15, 0, 0)
                label.BackgroundTransparency = 1
                label.Text = dropdownText
                label.TextColor3 = theme.text
                label.TextSize = 14
                label.Font = Enum.Font.Gotham
                label.TextXAlignment = Enum.TextXAlignment.Left
                label.Parent = dropdownFrame
                
                local selectedLabel = Instance.new("TextLabel")
                selectedLabel.Size = UDim2.new(0, 120, 0, 30)
                selectedLabel.Position = UDim2.new(1, -135, 0, 5)
                selectedLabel.BackgroundColor3 = theme.primary
                selectedLabel.Text = default
                selectedLabel.TextColor3 = theme.text
                selectedLabel.TextSize = 12
                selectedLabel.Font = Enum.Font.Gotham
                selectedLabel.Parent = dropdownFrame
                
                createCorner(selectedLabel, 6)
                
                local dropdownBtn = Instance.new("TextButton")
                dropdownBtn.Size = UDim2.new(1, 0, 1, 0)
                dropdownBtn.BackgroundTransparency = 1
                dropdownBtn.Text = ""
                dropdownBtn.Parent = dropdownFrame
                
                local listFrame = Instance.new("Frame")
                listFrame.Size = UDim2.new(0, 120, 0, math.min(#items * 35, 175))
                listFrame.Position = UDim2.new(1, -135, 1, 5)
                listFrame.BackgroundColor3 = theme.secondary
                listFrame.BorderSizePixel = 0
                listFrame.Visible = false
                listFrame.ZIndex = 10
                listFrame.Parent = dropdownFrame
                
                createCorner(listFrame, 6)
                createStroke(listFrame, theme.border, 1)
                
                local listScroll = Instance.new("ScrollingFrame")
                listScroll.Size = UDim2.new(1, 0, 1, 0)
                listScroll.BackgroundTransparency = 1
                listScroll.BorderSizePixel = 0
                listScroll.ScrollBarThickness = 4
                listScroll.ScrollBarImageColor3 = theme.accent
                listScroll.CanvasSize = UDim2.new(0, 0, 0, #items * 35)
                listScroll.Parent = listFrame
                
                local listLayout = Instance.new("UIListLayout")
                listLayout.Parent = listScroll
                
                for _, item in ipairs(items) do
                    local itemBtn = Instance.new("TextButton")
                    itemBtn.Size = UDim2.new(1, 0, 0, 35)
                    itemBtn.BackgroundColor3 = theme.secondary
                    itemBtn.BorderSizePixel = 0
                    itemBtn.Text = item
                    itemBtn.TextColor3 = theme.text
                    itemBtn.TextSize = 12
                    itemBtn.Font = Enum.Font.Gotham
                    itemBtn.Parent = listScroll
                    
                    itemBtn.MouseEnter:Connect(function()
                        tween(itemBtn, {BackgroundColor3 = theme.hover}, 0.2)
                    end)
                    
                    itemBtn.MouseLeave:Connect(function()
                        tween(itemBtn, {BackgroundColor3 = theme.secondary}, 0.2)
                    end)
                    
                    itemBtn.MouseButton1Click:Connect(function()
                        selectedLabel.Text = item
                        listFrame.Visible = false
                        setSetting("dropdown_" .. dropdownText, item)
                        callback(item)
                    end)
                end
                
                dropdownBtn.MouseButton1Click:Connect(function()
                    listFrame.Visible = not listFrame.Visible
                end)
                
                dropdownFrame.MouseEnter:Connect(function()
                    tween(dropdownFrame, {BackgroundColor3 = theme.hover}, 0.2)
                end)
                
                dropdownFrame.MouseLeave:Connect(function()
                    tween(dropdownFrame, {BackgroundColor3 = theme.secondary}, 0.2)
                end)
                
                return {
                    set = function(value)
                        selectedLabel.Text = value
                        setSetting("dropdown_" .. dropdownText, value)
                    end,
                    get = function()
                        return selectedLabel.Text
                    end
                }
            end
            
            function tab:addTextbox(options)
                options = options or {}
                local textboxText = options.text or "Textbox"
                local placeholder = options.placeholder or "Enter text..."
                local default = getSetting("textbox_" .. textboxText, options.default or "")
                local callback = options.callback or function() end
                
                local textboxFrame = Instance.new("Frame")
                textboxFrame.Size = UDim2.new(1, 0, 0, 40)
                textboxFrame.BackgroundColor3 = theme.secondary
                textboxFrame.BorderSizePixel = 0
                textboxFrame.Parent = tabContent
                
                createCorner(textboxFrame, 6)
                createStroke(textboxFrame, theme.border, 1)
                
                local label = Instance.new("TextLabel")
                label.Size = UDim2.new(1, -200, 1, 0)
                label.Position = UDim2.new(0, 15, 0, 0)
                label.BackgroundTransparency = 1
                label.Text = textboxText
                label.TextColor3 = theme.text
                label.TextSize = 14
                label.Font = Enum.Font.Gotham
                label.TextXAlignment = Enum.TextXAlignment.Left
                label.Parent = textboxFrame
                
                local textbox = Instance.new("TextBox")
                textbox.Size = UDim2.new(0, 170, 0, 30)
                textbox.Position = UDim2.new(1, -185, 0, 5)
                textbox.BackgroundColor3 = theme.primary
                textbox.Text = default
                textbox.PlaceholderText = placeholder
                textbox.TextColor3 = theme.text
                textbox.PlaceholderColor3 = theme.textDim
                textbox.TextSize = 12
                textbox.Font = Enum.Font.Gotham
                textbox.ClearTextOnFocus = false
                textbox.Parent = textboxFrame
                
                createCorner(textbox, 6)
                
                textbox.FocusLost:Connect(function()
                    setSetting("textbox_" .. textboxText, textbox.Text)
                    callback(textbox.Text)
                end)
                
                textboxFrame.MouseEnter:Connect(function()
                    tween(textboxFrame, {BackgroundColor3 = theme.hover}, 0.2)
                end)
                
                textboxFrame.MouseLeave:Connect(function()
                    tween(textboxFrame, {BackgroundColor3 = theme.secondary}, 0.2)
                end)
                
                return textbox
            end
            
            function tab:addLabel(text)
                local labelFrame = Instance.new("Frame")
                labelFrame.Size = UDim2.new(1, 0, 0, 30)
                labelFrame.BackgroundTransparency = 1
                labelFrame.Parent = tabContent
                
                local label = Instance.new("TextLabel")
                label.Size = UDim2.new(1, -20, 1, 0)
                label.Position = UDim2.new(0, 10, 0, 0)
                label.BackgroundTransparency = 1
                label.Text = text
                label.TextColor3 = theme.textDim
                label.TextSize = 13
                label.Font = Enum.Font.Gotham
                label.TextXAlignment = Enum.TextXAlignment.Left
                label.TextWrapped = true
                label.Parent = labelFrame
                
                return label
            end
            
            return tab
        end
        
        table.insert(lib.windows, window)
        return window
    end
    
    -- Theme switcher
    function lib:setTheme(themeName)
        if themes[themeName] then
            lib.theme = themes[themeName]
            lib.themeName = themeName
            setSetting("theme", themeName)
            
            -- Reload UI with new theme
            lib:notify({
                title = "Theme Changed",
                message = "Theme set to: " .. themeName,
                type = "success",
                duration = 2
            })
        end
    end
    
    return lib
end

return DollarwareLib
